<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>案件管理（概要）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- Bootstrap CSS (5系) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons CDN -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css" rel="stylesheet" />
  <!-- カスタムCSS -->
  <link rel="stylesheet" href="../style.css">
  <style>
    /* iPhone 17 Pro 393×852向け最適化 */
    body, html {
      width: 393px;
      height: 852px;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      overflow-y: auto;
    }
    .container-fluid {
      max-width: 393px;
      padding-bottom: 70px; /* フッター分のスペース */
      margin-top: 0.5rem;
    }
    .small-text { font-size: 0.7rem; }
    .project-title { white-space: nowrap; font-size: 0.9rem; }
    .info-table { font-size: 0.65rem; }
    .info-table th { background-color: #f8f9fa; width: 100px; }
    .budget-table { font-size: 0.65rem; }
    .budget-table th { background-color: #f8f9fa; }
    .conditions-list { font-size: 0.7rem; }
    .gantt-container { overflow-x: auto; }
    .gantt-table { font-size: 0.6rem; min-width: 600px; }
    .gantt-table th, .gantt-table td { text-align: center; padding: 2px 1px; }
    .gantt-table .task-name { text-align: left; white-space: nowrap; }
    .gantt-bar-planned { background-color: #0d6efd; height: 6px; border-radius: 2px; }
    .gantt-bar-actual { background-color: #198754; height: 6px; border-radius: 2px; margin-top: 2px; }
    .gantt-cell { position: relative; height: 20px; }
    .progress-good { color: #198754; font-weight: bold; }
    .progress-delay { color: #dc3545; font-weight: bold; }
    .clickable-card { text-decoration: none; color: inherit; display: block; }
    .clickable-card:hover { text-decoration: none; color: inherit; }
    .clickable-card .card { transition: box-shadow 0.2s, transform 0.2s; cursor: pointer; }
    .clickable-card:hover .card { box-shadow: 0 4px 12px rgba(0,0,0,0.15); transform: translateY(-2px); }
    /* Footer fixed */
    #footer-container {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 393px;
      z-index: 1000;
    }
    #footer-container footer {
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="container-fluid px-2">
    <!-- タイトル -->
    <h5 class="mb-2 mt-2 project-title fw-bold">国道９号舗装工事 <i class="bi bi-star"></i></h5>
    
    <!-- セクション1：工事概要（1カード） -->
    <div class="card mb-3 clickable-card" onclick="location.href='site_project_detail_overview.html'" style="cursor: pointer;">
      <div class="card-header py-2">
        <span class="fw-bold small-text">工事概要</span>
      </div>
      <div class="card-body p-2">
        <div class="row">
          <!-- 左側：工事種類・責任者・状況 -->
          <div class="col-12 mb-2">
            <table class="table table-sm table-bordered info-table mb-0">
              <tbody>
                <tr>
                  <th>工事種類</th>
                  <td>アスファルト舗装工事</td>
                </tr>
                <tr>
                  <th>責任者（社内）</th>
                  <td>山田太郎</td>
                </tr>
                <tr>
                  <th>状況</th>
                  <td>
                    <div class="d-flex align-items-center gap-2" onclick="event.stopPropagation()">
                      <select class="form-select form-select-sm" style="width: auto; font-size: 0.65rem;" id="statusSelect">
                        <option value="registered">案件登録済み</option>
                        <option value="in_progress" selected>工事中</option>
                        <option value="completed">工事完了</option>
                        <option value="inspection_done">出来方完了</option>
                      </select>
                      <button class="btn btn-primary btn-sm" style="font-size: 0.65rem; padding: 0.2rem 0.4rem;" onclick="saveStatus()">保存</button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- 右側：協力業者リスト -->
          <div class="col-12">
            <h6 class="mb-2" style="font-size: 0.7rem;">協力業者リスト</h6>
            <table class="table table-sm table-bordered info-table mb-0">
              <thead>
                <tr>
                  <th>業者名</th>
                  <th>担当工種</th>
                  <th>責任者</th>
                  <th>電話番号</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>東京舗装(株)</td>
                  <td>アスファルト舗装工</td>
                  <td>佐藤一郎</td>
                  <td>03-1234-5678</td>
                </tr>
                <tr>
                  <td>(株)関東建設</td>
                  <td>撤去工事</td>
                  <td>鈴木健二</td>
                  <td>03-2345-6789</td>
                </tr>
                <tr>
                  <td>首都圏道路(株)</td>
                  <td>区画線工</td>
                  <td>田中三郎</td>
                  <td>03-3456-7890</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- セクション2：予算・工事日誌（1カラム） -->
    <div class="mb-3">
      <!-- 予算 -->
      <div class="mb-2">
        <a href="site_project_detail_budget.html" class="clickable-card">
        <div class="card">
          <div class="card-header py-1">
            <span class="fw-bold small-text">予算・実績</span>
          </div>
          <div class="card-body p-2">
            <table class="table table-sm table-bordered budget-table mb-2">
              <thead>
                <tr>
                  <th>項目</th>
                  <th>予算</th>
                  <th>実績</th>
                  <th>進捗率</th>
                </tr>
              </thead>
              <tbody>
                <tr class="table-secondary">
                  <td class="fw-bold">直接工事費</td>
                  <td class="text-end">45,000,000</td>
                  <td class="text-end">20,250,000</td>
                  <td class="text-center">45%</td>
                </tr>
                <tr>
                  <td class="ps-2">アスファルト舗装工</td>
                  <td class="text-end">28,000,000</td>
                  <td class="text-end">12,600,000</td>
                  <td class="text-center">45%</td>
                </tr>
                <tr>
                  <td class="ps-2">撤去工事</td>
                  <td class="text-end">8,000,000</td>
                  <td class="text-end">8,000,000</td>
                  <td class="text-center">100%</td>
                </tr>
                <tr>
                  <td class="ps-2">区画線工</td>
                  <td class="text-end">9,000,000</td>
                  <td class="text-end">0</td>
                  <td class="text-center">0%</td>
                </tr>
                <tr class="table-secondary">
                  <td class="fw-bold">経費</td>
                  <td class="text-end">5,000,000</td>
                  <td class="text-end">2,000,000</td>
                  <td class="text-center">40%</td>
                </tr>
                <tr class="table-primary fw-bold">
                  <td>合計</td>
                  <td class="text-end">50,000,000</td>
                  <td class="text-end">22,250,000</td>
                  <td class="text-center">45%</td>
                </tr>
              </tbody>
            </table>
            <div class="progress" style="height: 15px;">
              <div class="progress-bar bg-success" role="progressbar" style="width: 45%;" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">45%</div>
            </div>
          </div>
        </div>
        </a>
      </div>

      <!-- 工事日誌 -->
      <div>
        <div class="card h-100">
          <div class="card-header py-1">
            <span class="fw-bold small-text">工事日誌（直近2日間）</span>
          </div>
          <div class="card-body p-2">
            <!-- 工事日誌新規作成ボタン -->
            <a href="site_project_detail_report_create.html" class="btn w-100 mb-2" style="font-size: 0.75rem; padding: 0.5rem; background: linear-gradient(135deg, #198754 0%, #20c997 100%); border: none; color: white; font-weight: bold; box-shadow: 0 4px 8px rgba(25, 135, 84, 0.3);">
              <i class="bi bi-plus-circle me-1"></i>工事日誌新規作成
            </a>
            <div onclick="location.href='site_project_detail_report.html'" style="cursor: pointer;">
            <!-- 3/14（最新日） -->
            <h6 class="mb-1" style="font-size: 0.65rem; border-bottom: 1px solid #dee2e6; padding-bottom: 2px;">
              <i class="bi bi-calendar-event me-1"></i>2026/03/14（土）
            </h6>
            <table class="table table-sm table-bordered budget-table mb-2">
              <thead>
                <tr>
                  <th>業者</th>
                  <th>工種</th>
                  <th>予算</th>
                  <th>当日実績</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>東京舗装(株)</td>
                  <td>アスファルト舗装工</td>
                  <td class="text-end">28,000,000</td>
                  <td class="text-end">850,000</td>
                </tr>
                <tr class="table-light">
                  <td colspan="2" class="fw-bold">経費</td>
                  <td class="text-end">5,000,000</td>
                  <td class="text-end">45,000</td>
                </tr>
              </tbody>
            </table>

            <!-- 3/13（前日） -->
            <h6 class="mb-1" style="font-size: 0.65rem; border-bottom: 1px solid #dee2e6; padding-bottom: 2px;">
              <i class="bi bi-calendar-event me-1"></i>2026/03/13（金）
            </h6>
            <table class="table table-sm table-bordered budget-table mb-0">
              <thead>
                <tr>
                  <th>業者</th>
                  <th>工種</th>
                  <th>予算</th>
                  <th>当日実績</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>東京舗装(株)</td>
                  <td>アスファルト舗装工</td>
                  <td class="text-end">28,000,000</td>
                  <td class="text-end">920,000</td>
                </tr>
                <tr class="table-light">
                  <td colspan="2" class="fw-bold">経費</td>
                  <td class="text-end">5,000,000</td>
                  <td class="text-end">38,000</td>
                </tr>
              </tbody>
            </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- セクション3：ガントチャート -->
    <a href="site_project_detail_schedule.html" class="clickable-card">
    <div class="card mb-3">
      <div class="card-header py-1">
        <span class="fw-bold small-text">スケジュール（2026年3月）</span>
      </div>
      <div class="card-body p-2 gantt-container">
        <table class="table table-bordered gantt-table mb-0">
          <thead>
            <tr>
              <th rowspan="2" style="width: 80px;">作業項目</th>
              <th rowspan="2" style="width: 30px;">区分</th>
              <th colspan="31">3月</th>
            </tr>
            <tr>
              <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th>
              <th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>19</th><th>20</th>
              <th>21</th><th>22</th><th>23</th><th>24</th><th>25</th><th>26</th><th>27</th><th>28</th><th>29</th><th>30</th><th>31</th>
            </tr>
          </thead>
          <tbody>
            <!-- 撤去工事 -->
            <tr>
              <td rowspan="2" class="task-name align-middle">撤去工事</td>
              <td class="bg-light">予定</td>
              <td colspan="5" class="p-0"><div class="gantt-bar-planned mx-1 mt-2"></div></td>
              <td colspan="26"></td>
            </tr>
            <tr>
              <td class="bg-light">実績</td>
              <td colspan="5" class="p-0"><div class="gantt-bar-actual mx-1 mt-2"></div></td>
              <td colspan="26"></td>
            </tr>
            <!-- アスファルト舗装工 -->
            <tr>
              <td rowspan="2" class="task-name align-middle">アスファルト舗装工</td>
              <td class="bg-light">予定</td>
              <td colspan="5"></td>
              <td colspan="15" class="p-0"><div class="gantt-bar-planned mx-1 mt-2"></div></td>
              <td colspan="11"></td>
            </tr>
            <tr>
              <td class="bg-light">実績</td>
              <td colspan="5"></td>
              <td colspan="9" class="p-0"><div class="gantt-bar-actual mx-1 mt-2"></div></td>
              <td colspan="17"></td>
            </tr>
            <!-- 区画線工 -->
            <tr>
              <td rowspan="2" class="task-name align-middle">区画線工</td>
              <td class="bg-light">予定</td>
              <td colspan="20"></td>
              <td colspan="8" class="p-0"><div class="gantt-bar-planned mx-1 mt-2"></div></td>
              <td colspan="3"></td>
            </tr>
            <tr>
              <td class="bg-light">実績</td>
              <td colspan="31"></td>
            </tr>
          </tbody>
        </table>
        <div class="mt-2 d-flex gap-3 small" style="font-size: 0.6rem;">
          <span><span class="d-inline-block" style="width:15px; height:8px; background-color:#0d6efd; border-radius:2px;"></span> 予定</span>
          <span><span class="d-inline-block" style="width:15px; height:8px; background-color:#198754; border-radius:2px;"></span> 実績</span>
        </div>
      </div>
    </div>
    </a>
  </div>
  
  <!-- フッター -->
  <div id="footer-container"></div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- カスタムスクリプト -->
  <script src="../style.js"></script>
  <script>
    fetch('site_footer.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById('footer-container').innerHTML = html;
        // 案件トップのリンクを削除（このページのみ）
        setTimeout(() => {
          const footerItems = document.querySelectorAll('#footer-container .footer-item');
          footerItems.forEach(item => {
            const link = item.querySelector('a[href="site_project_detail.html"]');
            if (link && link.querySelector('.bi-house-fill')) {
              item.remove();
            }
          });
        }, 100);
      });

    // 状況保存
    function saveStatus() {
      const status = document.getElementById('statusSelect').value;
      const statusLabels = {
        'registered': '案件登録済み',
        'in_progress': '工事中',
        'completed': '工事完了',
        'inspection_done': '出来方完了'
      };
      alert('状況を「' + statusLabels[status] + '」に保存しました。');
    }
  </script>
</body>
</html>
