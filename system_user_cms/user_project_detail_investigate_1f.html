<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>案件管理（現地調査1F）</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css" rel="stylesheet"/>
    <style>
        /* 全体左右マージン */
        .content-wrapper {
        margin: 0 auto;
        padding: 0 1rem;
        }
        /* カードを小さく */
        .card-project {
        font-size: 0.75rem;
        }
        .card-project .card-header {
        padding: 0.4rem 0.6rem;
        }
        .card-project .card-body {
        padding: 0.5rem;
        }
        .card-project .btn {
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
        }
        /* テーブル文字サイズ */
        .info-table td,
        .info-table th,
        .estimate-table td,
        .estimate-table th {
          font-size: 0.7rem;
        }
        /* 画像カラムの幅指定 */
        .img-col {
          width: 80%;
          padding-right: 0.5rem;
        }
        .table-col {
          width: 20%;
          padding-left: 0.5rem;
        }
        /* クリックで切り替わる画像 */
        #planImage {
          cursor: pointer;
          width: 100%;
          height: auto;
        }
    </style>
</head>
<body>
    <!-- ヘッダー -->
    <div id="header-container"></div>

    <div class="content-wrapper mt-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
            <h5 class="mb-0">会社名</h5>
            <h4 class="mb-0 d-inline">案件名 <i class="bi bi-star"></i></h4>
        </div>
        <div class="text-end">
            <span class="me-2">案件フロー:</span>
            <select class="form-select form-select-sm me-2" style="width:auto; display:inline-block;">
                <option value="registration">案件登録中</option>
                <option value="investigate">現地調査中</option>
                <option value="design">プラン中</option>
                <option value="estimate">提案完了</option>
                <option value="estimate">契約完了</option>
                <option value="estimate">終了</option>
                </select>
                <button class="btn btn-outline-primary btn-sm">変更</button>
            </div>
        </div>
    
        <!-- ワークフローバッジ -->
        <div class="d-flex justify-content-end mb-3">
            <span class="badge bg-light text-dark me-2">案件登録中</span>
            <span class="badge bg-primary me-2">現地調査中</span>
            <span class="badge bg-light text-dark me-2">プラン中</span>
            <span class="badge bg-light text-dark me-2">提案完了</span>
            <span class="badge bg-light text-dark me-2">契約完了</span>
            <span class="badge bg-light text-dark me-2">終了</span>
        </div>

        <!-- ナビゲーションタブ -->
        <ul class="nav nav-tabs mb-4">
        <li class="nav-item"><a class="nav-link"      href="user_project_detail.html">概要</a></li>
        <li class="nav-item"><a class="nav-link active" href="user_project_detail_investigate.html">現地調査</a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_designlist.html">プラン一覧</a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_doc.html">お客様資料</a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_chat.html">チャット <span class="badge bg-danger">5</span></a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_expartner.html">外部業務依頼</a></li>
        </ul>

        <!-- 戻るボタン -->
        <div class="d-flex justify-content-between align-items-center mb-3">
          <button class="btn btn-primary" type="button" onclick="location.href='user_project_detail_investigate.html'">
            <i class="bi bi-arrow-return-left"></i> 現地調査へ戻る
          </button>
        </div>
    
        <!-- Pill タブ -->
        <ul class="nav nav-pills mb-3">
          <li class="nav-item">
            <a class="nav-link active" href="#">1F</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">2F</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">敷地</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">北面</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">南面</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">西面</a>
          </li>
        </ul>
        
        <!-- コンテンツエリア -->
        <div class="d-flex">
          <!-- 左側：画像カラム（幅 4/5 相当）-->
          <div class="img-col">
            <!-- 初期表示 plan_edit.webp。クリックすると scan3d.webp に切り替える -->
            <img
              id="planImage"
              src="../images/plan_edit.webp"
              alt="プラン編集イメージ"
              onclick="
                const img = document.getElementById('planImage');
                img.src = (img.src.includes('plan_edit.webp') ? '../images/scan3d.webp' : '../images/plan_edit.webp');
              "
            >
          </div>
    
          <!-- 右側：調査項目タブ＋フォーム -->
          <div class="table-col">
            <ul class="nav nav-tabs mb-2" id="inspectionTab" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="tab-current" data-bs-toggle="tab" data-bs-target="#tab-current-pane" type="button" role="tab">現地調査</button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="tab-prepost" data-bs-toggle="tab" data-bs-target="#tab-prepost-pane" type="button" role="tab">事前・事後調査</button>
              </li>
            </ul>
            <div class="tab-content" id="inspectionTabContent">
              <div class="tab-pane fade show active" id="tab-current-pane" role="tabpanel">
                <form id="inspectionFormCurrent"></form>
              </div>
              <div class="tab-pane fade" id="tab-prepost-pane" role="tabpanel">
                <form id="inspectionFormPrepost"></form>
              </div>
            </div>
          </div>
        </div>
    </div>

    <!-- フッター -->
    <div id="footer-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- カスタムスクリプト -->
    <script src="../style.js"></script>
    <script>
        fetch('user_header.html').then(r => r.text()).then(html => document.getElementById('header-container').innerHTML = html);
        fetch('user_footer.html').then(r => r.text()).then(html => document.getElementById('footer-container').innerHTML = html);

        // [1] 基礎（構造）ボタンが押されたときに詳細を表示
        function showDetails() {
          document.getElementById('detailSection').classList.toggle('d-none');
        }

        // 調査項目名リスト
        const surveyItemsCurrent = [
          "柱","天井","窓","部屋","階段","採光","室内傷の調査","給排気設備","キッチン","レンジフード","キッチン壁天井","シンク","トイレ","分電盤","電気設備・配線箇所","建具とびら","洗面化粧台","お風呂","段差","基礎","土台","筋交い","床下断熱材","床下排気口","床防湿措置","面材","小屋裏断熱材","梁・横架材","継手又は仕口","トイレ浄化槽","床傾斜","柱傾斜","給排水設備","給湯設備","水道メーター","ガスメーター","電気設備・引込等","道路との高低差","敷地の湿潤状況","出水履歴"
        ];
        const surveyItemsPrepost = [
          "土地条件等; 盛土、地盤改良等","敷地の排水状況","がけ崩れ対策","用途地域","斜線制限","接道","防火地域","屋根","外壁材","外壁（雨水）","軒裏（雨水）","基礎：配筋、コンクリート強度","塀：配筋、コンクリート強度","増築部分","基礎のコンクリート、鉄筋JIS適","石綿","クロルピリホス","ホルムアルデヒド","地階における居室","壁面線の指定状況","道路内建築","外壁後退距離","高度地区内の建築物","地方公共団体の条例による制限","仮設計画"
        ];
        function createInspectionForm(items, formId) {
          const form = document.getElementById(formId);
          form.innerHTML = items.map((name, idx) => `
            <div class="mb-3">
              <label class="form-label">${idx+1}. ${name}</label>
              <input type="text" class="form-control" name="item${idx+1}" placeholder="入力してください">
            </div>
          `).join("");
        }
        createInspectionForm(surveyItemsCurrent, "inspectionFormCurrent");
        createInspectionForm(surveyItemsPrepost, "inspectionFormPrepost");
    </script>
</body>
</html>
