<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>案件管理（現地調査）</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.8.1/font/bootstrap-icons.min.css" rel="stylesheet"/>
    <style>
        /* 全体左右マージン */
        .content-wrapper {
        margin: 0 auto;
        padding: 0 1rem;
        }
        /* カードを小さく */
        .card-project {
        font-size: 0.75rem;
        }
        .card-project .card-header {
        padding: 0.4rem 0.6rem;
        }
        .card-project .card-body {
        padding: 0.5rem;
        }
        .card-project .btn {
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
        }
    </style>
    </head>
    <body>
    <!-- ヘッダー -->
    <div id="header-container"></div>

    <div class="content-wrapper mt-4">
        <div class="d-flex justify-content-between align-items-center mb-2">
        <div>
            <h5 class="mb-0">会社名</h5>
            <h4 class="mb-0 d-inline">案件名 <i class="bi bi-star"></i></h4>
        </div>
        <div class="text-end">
            <span class="me-2">案件フロー:</span>
            <select class="form-select form-select-sm me-2" style="width:auto; display:inline-block;">
                <option value="registration">案件登録済</option>
                <option value="investigate">現地調査済</option>
                <option value="design">プラン中</option>
                <option value="contract">契約完了</option>
                <option value="complete">他決完了</option>
                </select>
                <button class="btn btn-outline-primary btn-sm">変更</button>
            </div>
        </div>
    
        <!-- メインステータスバッジ（右寄せ） -->
        <div class="d-flex justify-content-end mb-3">
            <span class="badge bg-light text-dark me-2">案件登録済</span>
            <span class="badge bg-primary me-2">現地調査済</span>
            <span class="badge bg-light text-dark me-2">プラン中</span>
            <span class="badge bg-light text-dark me-2">契約完了</span>
            <span class="badge bg-light text-dark me-2">他決完了</span>
        </div>
        <!-- メインタブ（nav-tabs） -->
        <ul class="nav nav-tabs mb-4">
        <li class="nav-item"><a class="nav-link"      href="user_project_detail.html">概要</a></li>
        <li class="nav-item"><a class="nav-link active" href="user_project_detail_investigate.html">現地調査</a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_designlist.html">プラン一覧</a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_doc.html">お客様資料</a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_chat.html">チャット <span class="badge bg-danger">5</span></a></li>
        <li class="nav-item"><a class="nav-link"      href="user_project_detail_expartner.html">外部業務依頼</a></li>
        </ul>
        <!-- サブタブ用バッジ（右寄せ） -->
        <div class="d-flex justify-content-end align-items-center mb-2" style="gap:0.5rem;">
            <span class="badge bg-light text-dark">案件登録済</span>
            <span class="badge bg-light text-dark">お客様調整済</span>
            <span class="badge bg-light text-dark">図面作成済</span>
            <span class="badge bg-light text-dark">調査済</span>
            <span class="badge bg-light text-dark">調査報告書作成済</span>
        </div>
        <!-- サブタブ nav-pills（右寄せ） -->
        <ul class="nav nav-pills justify-content-end mb-4" id="investigateSubTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" href="user_project_detail_investigate.html"><i class="bi bi-person-lines-fill"></i> お客様調整</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" href="user_project_detail_investigate_create_figure.html"><i class="bi bi-pencil-square"></i> 図面作成</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" href="user_project_detail_investigate_edit.html"><i class="bi bi-clipboard-data"></i> 調査・編集</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" href="user_project_detail_investigate_result.html"><i class="bi bi-clipboard-check"></i> 調査結果</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" href="user_project_detail_investigate_images.html"><i class="bi bi-images"></i> 画像一覧</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" href="user_project_detail_investigate_report.html"><i class="bi bi-file-earmark-text"></i> 報告書プレビュー</a>
            </li>
        </ul>
        <div class="tab-content">
            <!-- お客様調整タブ -->
            <div class="tab-pane fade show active" id="sub-cust" role="tabpanel">
                <!-- 既存お客様調整カードをここに移動 -->
        <div class="card mb-5">
            <div class="card-header">
                <h5 class="mb-0">お客様調整</h5>
            </div>
            <div class="card-body" style="padding-top: 0.5rem;">
                <div class="row g-3">
                    <!-- 1. お客様システム登録案内 -->
                    <div class="col-md-4">
                        <div class="card border card-project h-100" style="margin-top: -3px;">
                            <div class="card-body text-center">
                                <h6 class="mb-2">
                                    お客様システム登録案内
                                    <span class="badge bg-danger text-light">お客様登録前</span>
                                </h6>
                                <button class="btn btn-primary btn-sm" onclick="openRegistrationModal()">お客様へメール送信</button>
                            </div>
                        </div>
                    </div>
                    <!-- 2. 現地調査日程調整 -->
                    <div class="col-md-4">
                        <div class="card border card-project h-100" style="margin-top: -3px;">
                            <div class="card-body text-center">
                                <h6 class="mb-2">
                                    現地調査日程調整
                                    <span class="badge bg-warning text-dark">現調日程調整前</span>
                                </h6>
                                <div class="mb-3">
                                    <input type="date" class="form-control form-control-sm d-inline-block me-2" style="width:auto;" value="2025-05-20">
                                    <input type="time" class="form-control form-control-sm d-inline-block" style="width:auto;" value="10:00">
                                </div>
                                <button class="btn btn-primary btn-sm" onclick="location.href='user_project_detail_investigate_schedule.html'">日程調整</button>
                            </div>
                        </div>
                    </div>
                    <!-- 3. お客様アンケート -->
                    <div class="col-md-4">
                        <div class="card border card-project h-100" style="margin-top: -3px;">
                            <div class="card-body text-center">
                                <h6 class="mb-2">
                                    お客様アンケート
                                    <span class="badge bg-danger text-light">未送信</span>
                                </h6>
                                <button class="btn btn-primary btn-sm" onclick="location.href='user_project_detail_investigate_questionnaire.html'">アンケート送信</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
            </div>
            <!-- 図面作成タブ -->
            <div class="tab-pane fade" id="sub-drawing" role="tabpanel">
                <div class="card mb-4">
                    <div class="card-header"><h5 class="mb-0">図面作成</h5></div>
                    <div class="card-body">
                        <!-- 物件情報表示 -->
                        <div class="mb-3">
                            <div>物件名：河本直己邸</div>
                            <div>物件種別：一戸建て住宅</div>
                            <div>物件構造：木造</div>
                            <div>戸建て階数：２階建て</div>
                            <div>地下室有無：無し</div>
                        </div>
                        <div class="d-flex flex-wrap gap-3">
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalDrawing1F">1F図面作成開始</button>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalDrawing2F">2F図面開始</button>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalDrawingSite">敷地図面作成開始</button>
                        </div>
                    </div>
                </div>
                <!-- 1F/2F/敷地 モーダル -->
                <div class="modal fade" id="modalDrawing1F" tabindex="-1" aria-labelledby="modalDrawing1FLabel" aria-hidden="true">
                    <div class="modal-dialog"><div class="modal-content">
                        <div class="modal-header"><h5 class="modal-title" id="modalDrawing1FLabel">1F図面作成</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                        <div class="modal-body d-grid gap-2">
                            <button class="btn btn-outline-primary">フリー制作</button>
                            <button class="btn btn-outline-primary">スキャン開始</button>
                            <button class="btn btn-outline-primary">写真取込</button>
                            <button class="btn btn-outline-primary">CAD取込</button>
                        </div>
                        <div class="modal-footer"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">閉じる</button></div>
                    </div></div>
                </div>
                <div class="modal fade" id="modalDrawing2F" tabindex="-1" aria-labelledby="modalDrawing2FLabel" aria-hidden="true">
                    <div class="modal-dialog"><div class="modal-content">
                        <div class="modal-header"><h5 class="modal-title" id="modalDrawing2FLabel">2F図面作成</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                        <div class="modal-body d-grid gap-2">
                            <button class="btn btn-outline-primary">フリー制作</button>
                            <button class="btn btn-outline-primary">スキャン開始</button>
                            <button class="btn btn-outline-primary">写真取込</button>
                            <button class="btn btn-outline-primary">CAD取込</button>
                        </div>
                        <div class="modal-footer"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">閉じる</button></div>
                    </div></div>
                </div>
                <div class="modal fade" id="modalDrawingSite" tabindex="-1" aria-labelledby="modalDrawingSiteLabel" aria-hidden="true">
                    <div class="modal-dialog"><div class="modal-content">
                        <div class="modal-header"><h5 class="modal-title" id="modalDrawingSiteLabel">敷地図面作成</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div>
                        <div class="modal-body d-grid gap-2">
                            <button class="btn btn-outline-primary">フリー制作</button>
                            <button class="btn btn-outline-primary">スキャン開始</button>
                            <button class="btn btn-outline-primary">写真取込</button>
                            <button class="btn btn-outline-primary">CAD取込</button>
                        </div>
                        <div class="modal-footer"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">閉じる</button></div>
                    </div></div>
                </div>
            </div>
            <!-- 調査・編集タブ -->
            <div class="tab-pane fade" id="sub-edit" role="tabpanel">
        <h5 class="mb-3">現地調査</h5>
        <div id="floorView" class="row row-cols-2 row-cols-md-3 row-cols-lg-6 g-3 mb-5">
        <!-- 1F カード -->
        <div class="col-6 col-md-4 col-lg-3">
            <div class="card card-project h-100 text-center" onclick="location.href='user_project_detail_investigate_1f.html'">
                <div class="card-header">1F</div>
                <img src="../images/1f.webp" class="card-img-top" alt="1F画像">
                </div>
            </div>
            <!-- 2F カード（モーダルを呼び出し） -->
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card card-project h-100 text-center" data-bs-toggle="modal" data-bs-target="#modal2F">
                <div class="card-header">2F</div>
                <div class="card-body d-flex justify-content-center align-items-center">
                    <button class="btn btn-primary">現地調査開始</button>
                </div>
                </div>
            </div>
            <!-- 敷地図 カード（モーダルを呼び出し） -->
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card card-project h-100 text-center" data-bs-toggle="modal" data-bs-target="#modalSite">
                <div class="card-header">敷地</div>
                <img src="../images/2f.webp" class="card-img-top" alt="敷地画像">
                </div>
            </div>
            <!-- 東面 カード（モーダルを呼び出し） -->
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card card-project h-100 text-center" data-bs-toggle="modal" data-bs-target="#modal2F">
                <div class="card-header">東面</div>
                <div class="card-body d-flex justify-content-center align-items-center">
                    <button class="btn btn-primary">現地調査開始</button>
                </div>
                </div>
            </div>
            <!-- 西面 カード（同様モーダル） -->
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card card-project h-100 text-center" data-bs-toggle="modal" data-bs-target="#modal2F">
                <div class="card-header">西面</div>
                <div class="card-body d-flex justify-content-center align-items-center">
                    <button class="btn btn-primary">現地調査開始</button>
                </div>
                </div>
            </div>
            <!-- 南面 カード（同様モーダル） -->
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card card-project h-100 text-center" data-bs-toggle="modal" data-bs-target="#modal2F">
                <div class="card-header">南面</div>
                <div class="card-body d-flex justify-content-center align-items-center">
                    <button class="btn btn-primary">現地調査開始</button>
                </div>
                </div>
            </div>
            <!-- 北面 カード（同様モーダル） -->
            <div class="col-6 col-md-4 col-lg-3">
                <div class="card card-project h-100 text-center" data-bs-toggle="modal" data-bs-target="#modal2F">
                <div class="card-header">北面</div>
                <div class="card-body d-flex justify-content-center align-items-center">
                    <button class="btn btn-primary">現地調査開始</button>
                </div>
                </div>
                    </div>
                </div>
            </div>
            <!-- 調査結果タブ -->
            <div class="tab-pane fade" id="sub-result" role="tabpanel">
                <!-- 空コンテンツ -->
            </div>
            <!-- 画像一覧タブ -->
            <div class="tab-pane fade" id="sub-images" role="tabpanel">
                <!-- 空コンテンツ -->
            </div>
            <!-- 報告書プレビューダブ -->
            <div class="tab-pane fade" id="sub-report" role="tabpanel">
                <!-- 空コンテンツ -->
            </div>
    </div>

    <!-- 2F モーダル -->
    <div class="modal fade" id="modal2F" tabindex="-1" aria-labelledby="modal2FLabel" aria-hidden="true">
        <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modal2FLabel">2F 調査開始</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body d-grid gap-2">
            <button class="btn btn-outline-primary">フリー制作</button>
            <button class="btn btn-outline-primary">スキャン開始</button>
            <button class="btn btn-outline-primary">写真取込</button>
            <button class="btn btn-outline-primary">CAD取込</button>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">閉じる</button></div>
        </div></div>
    </div>

    <!-- 敷地 モーダル -->
    <div class="modal fade" id="modalSite" tabindex="-1" aria-labelledby="modalSiteLabel" aria-hidden="true">
        <div class="modal-dialog"><div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modalSiteLabel">敷地調査開始</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body d-grid gap-2">
            <button class="btn btn-outline-primary">フリー制作</button>
            <button class="btn btn-outline-primary">スキャン開始</button>
            <button class="btn btn-outline-primary">写真取込</button>
            <button class="btn btn-outline-primary">GoogleMap取込</button>
            <button class="btn btn-outline-primary">公図取込</button>
        </div>
        <div class="modal-footer"><button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">閉じる</button></div>
        </div></div>
    </div>

    <!-- HAUSCAN登録案内モーダル -->
    <div class="modal fade" id="registrationModal" tabindex="-1" aria-labelledby="registrationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registrationModalLabel">HAUSCAN登録のお願い</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">件名</label>
                        <input type="text" class="form-control" value="HAUSCAN登録のお願い" readonly>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">本文</label>
                        <textarea class="form-control" rows="10" readonly>施主様

いつもお世話になっております。株式会社サンプル 支店：サンプル支店 担当：山田太郎です。

下記URLをから登録をお願いいたします。
ご不明な点がございましたらお気軽に下記電話番号までお問い合わせください。

URL: https://hauscan.example.com/register
電話番号: 03-1234-5678

よろしくお願いいたします。

株式会社サンプル
支店：サンプル支店
担当：山田太郎
TEL: 03-1234-5678</textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
                    <button type="button" class="btn btn-primary" onclick="sendRegistrationEmail()">送信</button>
                </div>
            </div>
        </div>
    </div>

    <!-- フッター -->
    <div id="footer-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- カスタムスクリプト -->
    <script src="../style.js"></script>
    <script>
        fetch('user_header.html').then(r => r.text()).then(html => document.getElementById('header-container').innerHTML = html);
        fetch('user_footer.html').then(r => r.text()).then(html => document.getElementById('footer-container').innerHTML = html);

        // HAUSCAN登録案内モーダルを開く関数
        function openRegistrationModal() {
            const registrationModal = new bootstrap.Modal(document.getElementById('registrationModal'));
            registrationModal.show();
        }

        // 登録案内メール送信関数
        function sendRegistrationEmail() {
            // ここにメール送信の処理を追加
            alert('HAUSCAN登録案内メールを送信しました');
            
            // ステータスバッジを更新
            const statusBadge = document.querySelector('.card:nth-child(2) .badge');
            statusBadge.textContent = '登録済み';
            statusBadge.className = 'badge bg-success text-light';
            
            // モーダルを閉じる
            const registrationModal = bootstrap.Modal.getInstance(document.getElementById('registrationModal'));
            registrationModal.hide();
        }
    </script>
</body>
</html>
